<!DOCTYPE html>
<html>
<head>
    <title>Smart mirror</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
    <script src="src/clock.js"></script>
    <script type="text/javascript">
		var socket = io('http://localhost:8081');
		socket.on('calEvents', function (data) {
			var calEvent, calEventsHTMLString = '', timeObj, timeString;
			for (var i = 0; i < data.calEvents.length; i++) {
				calEvent = data.calEvents[i];
				timeObj = new Date(calEvent.start.dateTime);
				var m = timeObj.getMinutes();
				if (m < 10) {
					m = "0" + m;
				}
				timeString = timeObj.getDate() + '/' +  (timeObj.getMonth()+1) + ' ' + timeObj.getHours() + ':' + m;
				calEventsHTMLString += "<b>"+ timeString + ":</b> " + calEvent.summary + "<br/>";
			}
			$('#calEvents').html(calEventsHTMLString);
		});
		socket.on('emails', function (data) {
			$('#emails').html('Unread emails: ' + data.numberOfUnreadEmails);
		});
		socket.on('forecast', function (data) {
			$('#div_weather h1:first').html(data.forecast.currently.temperature.toFixed(1) + "&deg;");
			$('#div_weather :eq(1)').html(data.forecast.currently.summary);
			$('#weatherCoords').html("Latitude: " + data.forecast.latitude + "<br/>Longitude: " + data.forecast.longitude);
		});
  
			function setSizeOnElements() {
				$('#content').css({
					top: $('#container').height(),
					width: $('#container').height(),
					height: $('#container').width()
				});
				$('#inner_content').css({
					width: $('#container').height()
				});
				$('#top_row, #middle_row, #bottom_row').css({
					height: $('#container').width() / 3
				});
			}
			$(window).resize(function () {
				setSizeOnElements();
			});
			$(document).ready(function () {
				setSizeOnElements();
				setTime();
			});

    </script>
</head>
<body>
<div id="container">
    <div id="content">
        <div id="inner_content">
            <div id="top_row">
                <div id="div_time" class="content_div_left">
                    <h1>00:00</h1>
                    <h4></h4>
                </div>
                <div id="div_weather" class="content_div_right">
                    <h1>Waiting for data...</h1>
                    <h4></h4>
                    <div id="weatherCoords"></div>
                </div>
            </div>
            <div id="middle_row">
                <div id="div_mail" class="content_div_left">
                    <h3>MAIL</h3>
                    <div id="emails">Waiting for data...</div>
                </div>
                <div id="div_calendar" class="content_div_right">
                    <h3>CALENDAR</h3>
                    <div id="calEvents">Waiting for data...</div>
                </div>
            </div>
            <div id="bottom_row">
                <div id="div_news" class="content_div_left">
                    <h3>NEWS</h3>
                    <h4>Test test...</h4>
                    <h4>Test test...</h4>
                    <h4>Test test...</h4>
                </div>
                <div id="div_technews" class="content_div_right">
                    <h3>TECH NEWS</h3>
                    <h4>Test test...</h4>
                    <h4>Test test...</h4>
                    <h4>Test test...</h4>
                    <h4>Test test...</h4>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
